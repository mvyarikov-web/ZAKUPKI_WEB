# increment-002 ‚Äî –ö—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª —Ä—è–¥–æ–º —Å ¬´–í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É¬ª

–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—É—à–∞ (–ú–°–ö): 1 –æ–∫—Ç—è–±—Ä—è 2025 –≥., 11:09  
Git commit hash: e45e949700e7be0d8cc81735fc79a8c36df41fa8

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞
–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫—Ä–∞—Å–Ω—É—é –∫–Ω–æ–ø–∫—É ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª, —Ä–∞–∑–º–µ—â—ë–Ω–Ω—É—é —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π ¬´–í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É¬ª. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª –¥–æ–ª–∂–Ω—ã —É–¥–∞–ª—è—Ç—å—Å—è:
- –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–∞–ø–∫–∏ –∏ —Ñ–∞–π–ª—ã –∏–∑ `uploads/`;
- –∏–Ω–¥–µ–∫—Å–Ω—ã–π —Ñ–∞–π–ª `index/_search_index.txt` –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ª—É–∂–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã (`index/search_results.json`);
- —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –∏ —Å—Ç–∞—Ç—É—Å—ã —Ñ–∞–π–ª–æ–≤ –≤ UI.

–í–∞–∂–Ω–æ: –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –æ—á–∏—â–∞—Ç—å—Å—è ‚Äî –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º.

## –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è —Ö–æ—á—É –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–¥–Ω–∏–º –¥–µ–π—Å—Ç–≤–∏–µ–º –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –Ω–µ —Ç–µ—Ä—è—è –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —Å —Ç–µ–º–∏ –∂–µ —Ç–µ—Ä–º–∏–Ω–∞–º–∏.

–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∞:
1) –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ —Å—Ç–∏–ª—å:
   - –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π ¬´–í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É¬ª.
   - –ö–Ω–æ–ø–∫–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–∞ (danger), –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–æ–∫.
2) –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:
   - –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –ø–∞–ø–∫–∏ –∏ —Ñ–∞–π–ª—ã –∏–∑ `uploads/` (—Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ), –∏–Ω–¥–µ–∫—Å `index/_search_index.txt`, —Ñ–∞–π–ª `index/search_results.json`.
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –∏ —Å—Ç–∞—Ç—É—Å—ã —Ñ–∞–π–ª–æ–≤ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã ¬´—Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞¬ª –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –¥–µ—Ä–µ–≤–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è).
3) –°—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞:
   - –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞ (–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
4) –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è JSON —Å –∏—Ç–æ–≥–æ–º: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, —Ñ–∞–∫—Ç –Ω–∞–ª–∏—á–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞, —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø—É—Ç–µ–π (–µ—Å–ª–∏ –±—ã–ª–∏).
5) –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
   - –û—à–∏–±–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –æ–±—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å; –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ.
   - –ò—Å–∫–ª—é—á—ë–Ω path traversal –∏ —É–¥–∞–ª–µ–Ω–∏–µ –≤–Ω–µ –ø–∞–ø–æ–∫ `uploads/` –∏ `index/`.

–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (Given/When/Then):
- Given –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Ñ–∞–π–ª—ã –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω –∏–Ω–¥–µ–∫—Å, When –Ω–∞–∂–∞—Ç—å ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª, Then `uploads/` –æ—á–∏—â–µ–Ω–∞, `index/_search_index.txt` —É–¥–∞–ª—ë–Ω, `search_results.json` –æ—á–∏—â–µ–Ω/—É–¥–∞–ª—ë–Ω, –ø–æ–ª–µ —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –æ—Å—Ç–∞–ª–æ—Å—å –ø—Ä–µ–∂–Ω–∏–º, UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—É—Å—Ç–æ–µ –¥–µ—Ä–µ–≤–æ.
- Given `uploads/` –∏ –∏–Ω–¥–µ–∫—Å –ø—É—Å—Ç—ã, When –Ω–∞–∂–∞—Ç—å ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª, Then —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —É—Å–ø–µ—Ö–æ–º –±–µ–∑ –æ—à–∏–±–æ–∫; –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏)

### –ë—ç–∫–µ–Ω–¥
–í —Ñ–∞–π–ª–µ `webapp/routes/files.py` –¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç `POST /clear_all`, –∫–æ—Ç–æ—Ä—ã–π:
1. –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º –≤ –ø–∞–ø–∫–µ `uploads/` –∏ —É–¥–∞–ª—è–µ—Ç –∏—Ö (—Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏)
2. –£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª –∏–Ω–¥–µ–∫—Å–∞ `index/_search_index.txt`, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ `index/search_results.json`, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. –û—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ —á–µ—Ä–µ–∑ `FilesState.clear()`
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ —Å–ø–∏—Å–∫–æ–º –æ—à–∏–±–æ–∫

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—ë—Ä–Ω—É—Ç—ã –≤ try/except, —á—Ç–æ–±—ã –æ—à–∏–±–∫–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏ –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å.

### –§—Ä–æ–Ω—Ç–µ–Ω–¥
**HTML (`templates/index.html`):**
- –ö–Ω–æ–ø–∫–∞ ¬´–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ¬ª –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞ –∏–∑ —Å–µ–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –≤ —Å–µ–∫—Ü–∏—é ¬´–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–ø–∫–∏¬ª, —Ç–µ–ø–µ—Ä—å –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π ¬´–í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É¬ª
- –°—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏ –∏–∑–º–µ–Ω—ë–Ω —Å `btn-secondary` –Ω–∞ `btn-danger` (–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç)
- –ò–∫–æ–Ω–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ üóëÔ∏è (–∫–æ—Ä–∑–∏–Ω–∞)

**JavaScript (`static/js/script.js`):**
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω:
1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º, —á—Ç–æ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/clear_all`
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
   - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
   - –û—á–∏—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –Ω–∞ UI
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ (–ø–æ–∫–∞–∂–µ—Ç –ø—É—Å—Ç–æ–µ –¥–µ—Ä–µ–≤–æ)
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∏–Ω–¥–µ–∫—Å–∞
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –¢–µ—Å—Ç—ã
–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/test_clear_all.py` —Å –¥–≤—É–º—è —Ç–µ—Å—Ç–∞–º–∏:
1. `test_clear_all_empty_folders` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –ø—É—Å—Ç—ã—Ö –ø–∞–ø–∫–∞—Ö
2. `test_clear_all_with_files` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤, –ø–∞–ø–æ–∫ –∏ –∏–Ω–¥–µ–∫—Å–∞

–û–±–∞ —Ç–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤.

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞ —Å–ª–µ–≤–∞ –æ—Ç —Ç–µ–∫—Å—Ç–∞ —Å –ø—É—Ç—ë–º –∫ –ø–∞–ø–∫–µ, —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ ¬´–í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É¬ª
- –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ —Ñ–∞–π–ª–æ–≤ –û–° –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—á–∏—Å—Ç–∫–∏
- –î–µ–π—Å—Ç–≤–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞: —É–¥–∞–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `uploads/` –∏ –∏–Ω–¥–µ–∫—Å –∏–∑ `index/`
- –ü–∞–ø–∫–∏ `uploads/` –∏ `index/` —Å–∞–º–∏ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è, —Ç–æ–ª—å–∫–æ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
