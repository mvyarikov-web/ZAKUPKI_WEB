# Инкремент 9: Расширение логики поиска и управление состоянием папок/архивов

## Постановка
1. **Не сворачивать архивы и папки автоматически:**
   - Архивы и папки должны оставаться развернутыми после открытия или выполнения поиска, если они не были свернуты вручную.
   - Если архив или папка были свернуты вручную, их состояние должно запоминаться и восстанавливаться при обновлении страницы или выполнении поиска.

2. **Добавить переключатель "Содержит/Не содержит" в строку поиска:**
   - Если переключатель установлен в состояние "Содержит", логика поиска остается неизменной.
   - Если переключатель установлен в состояние "Не содержит":
     - Зеленым светофором помечаются файлы, которые **не содержат** слова поиска.
     - В результатах отображается слово с префиксом "не содержит" (например, "не содержит: договор").
     - Слово "не содержит" перед словом поиска должно быть выделено красным цветом
     - В превью выводится аналогичное количество текста с начала документа, как и в текущей реализации, но только один сниппет.
     - Визуализация и сортировка остаются такими же: файлы, соответствующие критерию "не содержит", выводятся в начале, остальные — в конце.

## Спецификация
### 1. Управление состоянием папок и архивов
- **Frontend:**
  - Добавить обработку состояния папок и архивов в localStorage.
  - При загрузке страницы или обновлении списка файлов восстанавливать состояние (развернуто/свернуто) из localStorage.
  - При ручном сворачивании/разворачивании обновлять состояние в localStorage.

- **Backend:**
  - Изменений не требуется.

### 2. Переключатель "Содержит/Не содержит"
- **Frontend:**
  - Добавить переключатель (toggle) в строку поиска.
  - При изменении состояния переключателя обновлять параметр запроса к API.
  - Обновить визуализацию результатов:
    - Добавить префикс "не содержит" к словам поиска в результатах.
    - Ограничить количество сниппетов до одного для режима "Не содержит".

- **Backend:**
  - Расширить API поиска:
    - Добавить параметр `exclude_mode` (булево значение).
    - Если `exclude_mode=True`, фильтровать файлы, которые **не содержат** слова поиска.
    - Возвращать результаты с пометкой "не содержит".

## Реализация (простыми словами)
1. **Frontend:**
   - Добавить переключатель "Содержит/Не содержит" в HTML-шаблон.
   - Обновить JavaScript для обработки переключателя и обновления параметров поиска.
   - Реализовать сохранение состояния папок/архивов в localStorage.

2. **Backend:**
   - Обновить метод поиска в `Searcher` для обработки параметра `exclude_mode`.
   - Добавить фильтрацию файлов, которые не содержат слова поиска.

## Примечания
- Все изменения должны быть покрыты автотестами.
- Убедиться, что новый функционал не ломает существующую логику поиска и отображения.
- Слово "не содержит" перед словом поиска должно быть выделено красным цветом.