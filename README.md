# ZAKUPKI_WEB - –ü–∞–∫–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤. –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

# ZAKUPKI_WEB ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∏—Å–∫–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –æ–±–∑–æ—Ä —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –í—Å—è –ª–æ–≥–∏–∫–∞ ‚Äî –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∏–º–µ–Ω–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ –∫–æ–¥–µ ‚Äî –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (PEP8).

## –ß—Ç–æ —ç—Ç–æ
–í–µ–±‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Flask –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤ PostgreSQL –∏ –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É. –ü–æ–¥–¥–µ—Ä–∂–∞–Ω—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã, –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º, —Ç–æ–∫–µ–Ω—ã AI‚Äë–º–æ–¥–µ–ª–µ–π –∏ –ø–ª–∞–Ω–æ–≤—ã–π GC.

## –û—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- –ì–ª–∞–≤–Ω–∞—è: –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤/–ø–∞–ø–æ–∫, —Å—Ç–∞—Ç—É—Å –∏–Ω–¥–µ–∫—Å–∞, –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º, –≤—ã–¥–∞—á–∞ —Å–æ —Å–Ω–∏–ø–ø–µ—Ç–∞–º–∏.
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–∞ (/view): —Ç–µ–∫—Å—Ç + –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤, –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è.
- –ê–¥–º–∏–Ω‚Äë–ø–∞–Ω–µ–ª—å (/admin): –∫–≤–æ—Ç—ã, –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ GC, –∑–∞–ø—É—Å–∫ GC, –ª–æ–≥–∏ –∞—É–¥–∏—Ç–∞, –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–æ–∫.
- API‚Äë–∫–ª—é—á–∏ (/api_keys): —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (Fernet, PostgreSQL), CRUD.
- AI‚Äë–∞–Ω–∞–ª–∏–∑ (/ai_rag): –ø—Ä—è–º–æ–π –∞–Ω–∞–ª–∏–∑ –∏–ª–∏ —Å RAG, –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏, —Å—á—ë—Ç—á–∏–∫ —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏.

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
1) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install -r requirements.txt
2) –ó–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–º–∏–Ω–∏–º—É–º):
   - DATABASE_URL ‚Äî —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
   - FERNET_ENCRYPTION_KEY ‚Äî –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è API‚Äë–∫–ª—é—á–µ–π
   - JWT_SECRET_KEY ‚Äî —Å–µ–∫—Ä–µ—Ç –¥–ª—è JWT
   - USE_DATABASE=true
3) –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: python app.py

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç 5000. –°—Ç–∞—Ç–∏–∫–∞ ‚Äî –ø–∞–ø–∫–∏ templates/ –∏ static/.

## –ß—Ç–æ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º (–∫–æ—Ä–æ—Ç–∫–æ)
- –ë–î: PostgreSQL + SQLAlchemy. –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã: users, documents, chunks, ai_messages, prompts, token_usage, logs.
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è: —á–∞–Ω–∫–∏ –ø–æ 500 —Ç–æ–∫–µ–Ω–æ–≤ (–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ 50), –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ sha256, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç –ø–æ root_hash –ø–∞–ø–∫–∏, —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ –ë–î.
- –ü–æ–∏—Å–∫: —Ç–æ–ª—å–∫–æ –ø–æ –ë–î (—Ç–∞–±–ª–∏—Ü–∞ chunks). –°–Ω–∏–ø–ø–µ—Ç—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º, –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç.
- –ó–∞–≥—Ä—É–∑–∫–∞: –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ uploads/, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ UI —Å–µ—Ä—ã–º.
- –¢–æ–∫–µ–Ω—ã/—Å—Ç–æ–∏–º–æ—Å—Ç—å: –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É token_usage; —Ñ–∞–π–ª–æ–≤–æ–µ token_usage.json —É–¥–∞–ª–µ–Ω–æ.
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫: APScheduler ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π GC, –æ—á–∏—Å—Ç–∫–∞ —Å–µ—Å—Å–∏–π; —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ /admin.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: PDF, DOC/DOCX, XLS/XLSX, TXT, HTML/HTM, CSV/TSV, XML, JSON. OCR –∏ RAR ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (graceful degrade).

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—É—Ç–∏, –∑–∞—â–∏—Ç–∞ –æ—Ç traversal; –ª–∏–º–∏—Ç –∑–∞–≥—Ä—É–∑–æ–∫ –ø–æ —Ä–∞–∑–º–µ—Ä—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É.
- JWT‚Äë–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏–ª–∏ —Ç–æ–∫–µ–Ω –≤ —Å—Å—ã–ª–∫–µ –¥–ª—è /view). –†–æ–ª–∏: user/admin.
- –í—Å–µ JSON –≤ UTF‚Äë8; –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö; –æ–±—Ä–∞–±–æ—Ç–∫–∞ 413.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (ENV)
- USE_DATABASE=true ‚Äî –≤—Å–µ–≥–¥–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- MAX_UPLOAD_SIZE_MB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100)
- REQUEST_TIMEOUT (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30)
- GC_SCHEDULE_ENABLED=true, GC_SCHEDULE_HOUR=3, GC_THRESHOLD_SCORE=-10.0, GC_MAX_DELETIONS=100
- VECTOR_DIMENSION=1536 (–¥–ª—è pgvector, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≤–∞–∂–Ω–æ–µ)
- app.py ‚Äî –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ Flask
- webapp/ ‚Äî –∫–æ–Ω—Ñ–∏–≥, –ë–î‚Äë–º–æ–¥–µ–ª–∏, –º–∞—Ä—à—Ä—É—Ç—ã, —Å–µ—Ä–≤–∏—Å—ã, middleware, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- document_processor/ ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã (legacy‚Äë—á–∞—Å—Ç–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤—ã—á–∏—â–∞—é—Ç—Å—è)
- templates/, static/ ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- uploads/, index/, logs/ ‚Äî —Ä–∞–±–æ—á–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏ (–∏–Ω–¥–µ–∫—Å –¥–ª—è —Ç–µ—Ö—Ñ–∞–π–ª–æ–≤; –∫–æ–Ω—Ç–µ–Ω—Ç –∏ –º–µ—Ç—Ä–∏–∫–∏ ‚Äî –≤ –ë–î)

## –¢–µ—Å—Ç—ã
pytest -q –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –Ω–∞–±–æ—Ä. –¢—è–∂—ë–ª—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (OCR/–∞—Ä—Ö–∏–≤—ã) –≤—ã–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –∏ in‚Äëmemory –ë–î –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–æ–≥–æ–Ω–∞–≤.

## –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –≤–∫–ª–∞–¥
–ö–æ–º–º–∏—Ç—ã ‚Äî –Ω–∞ —Ä—É—Å—Å–∫–æ–º –≤ —Å—Ç–∏–ª–µ Conventional Commits. PR: —Ü–µ–ª—å, –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –º–æ–¥—É–ª–∏, —Ä–∏—Å–∫–∏, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤–µ–¥—ë–º –≤ increments_doc/.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã –∏ –∫–æ–¥. –≠—Ç–æ—Ç README –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –ø—Ä–æ—Å—Ç–æ–π.