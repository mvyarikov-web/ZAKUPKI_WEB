# restart_server.py โ ะััััะฐั ะฟะตัะตะทะฐะณััะทะบะฐ ัะตัะฒะตัะฐ

ะะพะดัะปั ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะน ะฟะตัะตะทะฐะณััะทะบะธ Flask-ัะตัะฒะตัะฐ ั ะพัะฒะพะฑะพะถะดะตะฝะธะตะผ ะทะฐะฝััะพะณะพ ะฟะพััะฐ.

## ๐ ะัััััะน ััะฐัั

### ะกะฐะผัะน ะฟัะพััะพะน ัะฟะพัะพะฑ (ะธะท ะบะพัะฝั ะฟัะพะตะบัะฐ):

```bash
# ะะตัะตะทะฐะฟััะบ ะฝะฐ ะฟะพััั 8081 (ะฟะพ ัะผะพะปัะฐะฝะธั ะดะปั ััะพะณะพ ะฟัะพะตะบัะฐ)
python3 restart_server.py

# ะะตัะตะทะฐะฟััะบ ะฝะฐ ะฟะพััั 5000
python3 restart_server.py --port 5000 --command "FLASK_PORT=5000 python3 app.py"
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะบะพะดะต:

```python
from restart_server import ServerReloader

# ะะตัะตะทะฐะฟััะบ ัะตัะฒะตัะฐ ะฝะฐ ะฟะพััั 5000
reloader = ServerReloader(port=5000, start_command="python3 app.py")
reloader.restart()

# ะขะพะปัะบะพ ะพัะฒะพะฑะพะถะดะตะฝะธะต ะฟะพััะฐ ะฑะตะท ะทะฐะฟััะบะฐ
reloader.free_port()
```

## ๐ ะะฐัะฐะผะตััั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ

```bash
python3 restart_server.py --help
```

- `--port`, `-p` โ ะะพะผะตั ะฟะพััะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั: 8081)
- `--command`, `-c` โ ะะพะผะฐะฝะดะฐ ะทะฐะฟััะบะฐ ัะตัะฒะตัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั: "python3 app.py")
- `--wait`, `-w` โ ะัะตะผั ะพะถะธะดะฐะฝะธั ะผะตะถะดั ะพััะฐะฝะพะฒะบะพะน ะธ ะทะฐะฟััะบะพะผ ะฒ ัะตะบัะฝะดะฐั (ะฟะพ ัะผะพะปัะฐะฝะธั: 2.5)

## ๐ก ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะััััะฐั ะฟะตัะตะทะฐะณััะทะบะฐ ัะตะบััะตะณะพ ัะตัะฒะตัะฐ:
```bash
python3 restart_server.py
```

### ะะตัะตะทะฐะฟััะบ ั ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั:
```bash
python3 restart_server.py -p 5000 -c "FLASK_PORT=5000 python3 app.py"
```

### ะขะพะปัะบะพ ะพัะธััะบะฐ ะฟะพััะฐ:
```python
from restart_server import ServerReloader
ServerReloader(8081, "dummy").free_port()
```

## ๐ง ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน (ะพะฟัะธะพะฝะฐะปัะฝะพ)

ะะปั ะฑะพะปะตะต ะฝะฐะดัะถะฝะพะน ัะฐะฑะพัั ัะตะบะพะผะตะฝะดัะตััั ัััะฐะฝะพะฒะธัั `psutil`:

```bash
pip install psutil
```

ะะตะท `psutil` ะผะพะดัะปั ะธัะฟะพะปัะทัะตั ัะธััะตะผะฝัะต ะบะพะผะฐะฝะดั (`lsof` ะฝะฐ macOS, `fuser` ะฝะฐ Linux).

## โ ะะพะทะผะพะถะฝะพััะธ

- โ ะะฒัะพะผะฐัะธัะตัะบะพะต ะพัะฒะพะฑะพะถะดะตะฝะธะต ะฟะพััะฐ
- โ Graceful shutdown ะฟัะพัะตััะพะฒ
- โ ะะฐะฑะพัะฐะตั ะฑะตะท `psutil` (fallback ะฝะฐ ัะธััะตะผะฝัะต ะบะพะผะฐะฝะดั)
- โ ะะพะดัะพะฑะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะฒัะตั ะดะตะนััะฒะธะน
- โ ะัะพััะพะน API ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฒ ะบะพะดะต
- โ ะฃะดะพะฑะฝัะน CLI ะธะฝัะตััะตะนั

## ๐ ะะตัะพะดั ะบะปะฐััะฐ ServerReloader

### `__init__(port, start_command, wait_time=2.5)`
ะะฝะธัะธะฐะปะธะทะฐัะธั ะฟะตัะตะทะฐะณััะทัะธะบะฐ.

### `free_port() -> bool`
ะัะฒะพะฑะพะถะดะฐะตั ะฟะพัั, ะทะฐะฒะตััะฐั ะฟัะพัะตััั.

### `start_server() -> Optional[subprocess.Popen]`
ะะฐะฟััะบะฐะตั ัะตัะฒะตั ั ัะบะฐะทะฐะฝะฝะพะน ะบะพะผะฐะฝะดะพะน.

### `restart() -> bool`
ะะพะปะฝัะน ัะธะบะป: ะพัะฒะพะฑะพะถะดะตะฝะธะต โ ะพะถะธะดะฐะฝะธะต โ ะทะฐะฟััะบ.

## ๐ฏ ะะฐัะฟะพะปะพะถะตะฝะธะต

ะะพะดัะปั ะฝะฐัะพะดะธััั ะฒ **ะบะพัะฝะต ะฟัะพะตะบัะฐ** ะดะปั ะฑััััะพะณะพ ะดะพัััะฟะฐ:
```
web_interface/
โโโ restart_server.py    โ ะะดะตัั!
โโโ app.py
โโโ requirements.txt
โโโ ...
```

ะขะฐะบะถะต ะดะพัััะฟะฝะฐ ะบะพะฟะธั ะฒ `utils/server_reloader.py` ะดะปั ะธะผะฟะพััะฐ ะธะท ะดััะณะธั ะผะพะดัะปะตะน.

---

**ะกะพะฒะตั:** ะะปั ะตะถะตะดะฝะตะฒะฝะพะน ัะฐะฑะพัั ะฟัะพััะพ ะทะฐะฟััะบะฐะนัะต `python3 restart_server.py` ะธะท ะบะพัะฝั ะฟัะพะตะบัะฐ! ๐
