# –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç: –í–µ–±-–ø–æ–∏—Å–∫ Perplexity Sonar —á–µ—Ä–µ–∑ UI

**–î–∞—Ç–∞:** 3 –Ω–æ—è–±—Ä—è 2025 –≥.
**–ê–≤—Ç–æ—Ä:** GitHub Copilot

---

## –ö—Ä–∞—Ç–∫–æ –æ –ø—Ä–æ–±–ª–µ–º–µ
- –í–µ–±-–ø–æ–∏—Å–∫ Perplexity Sonar –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∏–∑ UI, –¥–∞–∂–µ —Å –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –≥–∞–ª–æ—á–∫–æ–π "–° –ø–æ–∏—Å–∫–æ–º".
- –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–ª, –Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞–ª–∞ "–Ø –Ω–µ –º–æ–≥—É –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Å–∞–π—Ç—ã".
- –ü—Ä–∏—á–∏–Ω–∞: –º–æ–¥–µ–ª—å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞, –µ—Å–ª–∏ –≤ –ø—Ä–æ–º–ø—Ç–µ —É–∂–µ –µ—Å—Ç—å –±–æ–ª—å—à–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
- OpenAI SDK –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ `extra_body` (–≤–∏–¥–Ω–æ –∫–∞–∫ `extra_json` –≤ –ª–æ–≥–∞—Ö), –Ω–æ Perplexity –º–æ–∂–µ—Ç –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫, –µ—Å–ª–∏ —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
    - –í—Ö–æ–¥—è—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ (search_enabled, search_params)
    - –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ search_params
    - –ò—Ç–æ–≥–æ–≤—ã–π extra_body –¥–ª—è Perplexity
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ search_enabled –∏ search_params –≤–æ –≤—Å–µ—Ö fallback-–ø—É—Ç–∏ (direct analyze)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç: —Å—Ü–µ–Ω–∞—Ä–∏–π UI —Å –ø—É—Å—Ç—ã–º–∏ search_params
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: extra_body —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –î–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –≤–µ–±-–ø–æ–∏—Å–∫–∞:
    - –Ø–≤–Ω–æ –ø—Ä–æ—Å–∏—Ç—å –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø–æ–∏—Å–∫ –≤ system-–ø—Ä–æ–º–ø—Ç–µ –∏–ª–∏ –Ω–∞—á–∞–ª–µ user-–ø—Ä–æ–º–ø—Ç–∞ ("–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π –≤–µ–±-–ø–æ–∏—Å–∫ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å")
    - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
    - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏: –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∏ `üåê –†–µ–∂–∏–º –° –ü–û–ò–°–ö–û–ú`, –∞ –≤ –∑–∞–ø—Ä–æ—Å–µ –∫ API ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∞–º–æ–π Perplexity (—Ä–µ—à–∞–µ—Ç –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É).

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
1. –í–∫–ª—é—á–∏—Ç—å –≥–∞–ª–æ—á–∫—É "–° –ø–æ–∏—Å–∫–æ–º" –≤ UI, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å —Å —è–≤–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º –≤–µ–±-–ø–æ–∏—Å–∫–∞.
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∏
    - `üîç DEBUG DIRECT: is_sonar=True, search_enabled=True, search_params={}`
    - `üåê –†–µ–∂–∏–º –° –ü–û–ò–°–ö–û–ú (fallback): extra_body = {...}`
3. –í –æ—Ç–≤–µ—Ç–µ –º–æ–¥–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ —Ö–æ—Ç—è –±—ã –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–∏—Å–∫–∞.

## –§–∞–π–ª—ã –∏ –∫–æ–º–º–∏—Ç—ã
- –ò–∑–º–µ–Ω–µ–Ω–æ: `webapp/routes/ai_rag.py`, `webapp/services/rag_service.py`, `tests/test_perplexity_ui_path.py`
- –ö–æ–º–º–∏—Ç: e90fbd2
- –¢–µ—Å—Ç: `tests/test_perplexity_ui_path.py` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π UI

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ú–æ–¥–µ–ª—å Perplexity Sonar –º–æ–∂–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫, –µ—Å–ª–∏ –≤ –ø—Ä–æ–º–ø—Ç–µ –µ—Å—Ç—å –±–æ–ª—å—à–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
- OpenAI SDK –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–æ–∏—Å–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –º–æ–¥–µ–ª–∏.

---

**–†–µ—à–µ–Ω–∏–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ, –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã.**
