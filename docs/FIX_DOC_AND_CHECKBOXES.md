# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ DOC —Ñ–∞–π–ª–æ–≤ –∏ —á–µ–∫–±–æ–∫—Å–æ–≤

**–î–∞—Ç–∞:** 2025-10-23  
**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö DOC —Ñ–∞–π–ª–æ–≤ (–Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ 23%)
2. –í–∏–∑—É–∞–ª—å–Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —á–µ–∫–±–æ–∫—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

---

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –£–ª—É—á—à–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ DOC —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª:** `document_processor/search/indexer.py`

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞—Å–∫–∞–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è:**

```python
def _extract_doc(self, path: str) -> str:
    """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ DOC.
    
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è (—Å fallback):
    1. antiword (—Å–∏—Å—Ç–µ–º–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞) ‚Äî –Ω–∞–∏–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
    2. textract (Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞) ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
    3. python-docx ‚Äî –∏–Ω–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö DOC
    4. Fallback: –±–∏–Ω–∞—Ä–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å cp1251 ‚Äî –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
    """
```

**–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:**
- `_try_antiword(path)` ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—É—é —É—Ç–∏–ª–∏—Ç—É antiword
- `_try_textract(path)` ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É textract
- `_try_docx_for_doc(path)` ‚Äî –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å DOC –∫–∞–∫ DOCX

**–ü–æ—Ä–æ–≥ –∫–∞—á–µ—Å—Ç–≤–∞:** –ú–∏–Ω–∏–º—É–º 50 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ø—Ä–∏–∑–Ω–∞–Ω–∏—è –º–µ—Ç–æ–¥–∞ —É—Å–ø–µ—à–Ω—ã–º

---

### 2. –£–ª—É—á—à–µ–Ω—ã —Å—Ç–∏–ª–∏ —á–µ–∫–±–æ–∫—Å–æ–≤

**–§–∞–π–ª:** `static/css/styles.css`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```css
.file-checkbox {
    cursor: pointer;
    width: 18px;          /* –£–≤–µ–ª–∏—á–µ–Ω —Å 16px */
    height: 18px;         /* –£–≤–µ–ª–∏—á–µ–Ω —Å 16px */
    accent-color: #3498db; /* –°–∏–Ω–∏–π —Ü–≤–µ—Ç –≥–∞–ª–æ—á–∫–∏ */
    flex-shrink: 0;       /* –ù–µ —Å–∂–∏–º–∞—Ç—å –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –º–µ—Å—Ç–∞ */
}

.file-checkbox:hover {
    transform: scale(1.1);    /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    transition: transform 0.2s ease;
}

.file-checkbox:checked {
    background-color: #3498db;
}

.file-checkbox:disabled {
    cursor: not-allowed;
    opacity: 0.4;             /* –°–Ω–∏–∂–µ–Ω–∞ —Å 0.5 */
    filter: grayscale(100%);  /* –°–µ—Ä—ã–π —Ü–≤–µ—Ç –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö */
}
```

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä —á–µ–∫–±–æ–∫—Å–æ–≤ (18√ó18px)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ü–≤–µ—Ç–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç (—Å–∏–Ω–∏–π)
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (scale 1.1)
- ‚úÖ –ß—ë—Ç–∫–æ–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ DOC (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### macOS (—á–µ—Ä–µ–∑ Homebrew):
```bash
brew install antiword
```

#### Ubuntu/Debian:
```bash
sudo apt-get install antiword
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
antiword -v
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)

```bash
pip install textract
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `textract` —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Å–º. [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](https://textract.readthedocs.io/))

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç: `tests/test_doc_extraction.py`

**–°—Ü–µ–Ω–∞—Ä–∏–∏:**
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è DOC
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ fallback –º–µ—Ç–æ–¥–∞ (–±–∏–Ω–∞—Ä–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥)
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ antiword
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ textract
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –º–µ—Ç–æ–¥–æ–≤

**–ó–∞–ø—É—Å–∫:**
```bash
pytest tests/test_doc_extraction.py -v -s
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ 3 —Ç–µ—Å—Ç–∞ –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚ö†Ô∏è 3 —Ç–µ—Å—Ç–∞ –ø—Ä–æ–ø—É—â–µ–Ω—ã (antiword –∏ textract –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ë–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
- –ö–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è DOC: **23-40%** (–±–∏–Ω–∞—Ä–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å cp1251)
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è: –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö DOC —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π

### –° antiword:
- –ö–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è DOC: **80-95%** ‚úÖ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: —Ç–∞–±–ª–∏—Ü, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–∏—Ä–∏–ª–ª–∏—Ü—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –° textract:
- –ö–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è DOC: **70-90%**
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```
http://127.0.0.1:8081
```

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ DOC —Ñ–∞–π–ª

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
- ‚úÖ –ß–µ–∫–±–æ–∫—Å—ã –≤–∏–¥–Ω—ã —Ä—è–¥–æ–º —Å —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –ß–µ–∫–±–æ–∫—Å—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
- ‚úÖ –ß–µ–∫–±–æ–∫—Å—ã —Å–∏–Ω–∏–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
- ‚úÖ –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —á–µ–∫–±–æ–∫—Å—ã —Å–µ—Ä—ã–µ (–¥–ª—è –Ω–µ—á–∏—Ç–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤)

### 4. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω–¥–µ–∫—Å –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:
- **–î–æ —É–ª—É—á—à–µ–Ω–∏–π:** –ö–∞—á–µ—Å—Ç–≤–æ 23%, –º–∞–ª–æ —Å–∏–º–≤–æ–ª–æ–≤
- **–ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π (—Å antiword):** –ö–∞—á–µ—Å—Ç–≤–æ 80-95%, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç
- **–ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π (–±–µ–∑ antiword):** –ö–∞—á–µ—Å—Ç–≤–æ 23-40%, fallback —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- **antiword** ‚Äî —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
- **textract** ‚Äî –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–µ–µ
- **fallback** ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –Ω–æ –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

### –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –º–µ—Ç–æ–¥–∞:
1. –ï—Å–ª–∏ antiword —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≤–µ—Ä–Ω—É–ª ‚â•50 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è antiword ‚úÖ
2. –ò–Ω–∞—á–µ –µ—Å–ª–∏ textract —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≤–µ—Ä–Ω—É–ª ‚â•50 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è textract
3. –ò–Ω–∞—á–µ –µ—Å–ª–∏ python-docx —Å–º–æ–≥ –æ—Ç–∫—Ä—ã—Ç—å ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è python-docx
4. –ò–Ω–∞—á–µ ‚Üí –±–∏–Ω–∞—Ä–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞)

### Graceful degradation:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ antiword/textract **—É–ª—É—á—à–∞–µ—Ç**, –Ω–æ **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è**
- –ù–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üöÄ –°—Ç–∞—Ç—É—Å

- ‚úÖ –ö–æ–¥ —É–ª—É—á—à–µ–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –ß–µ–∫–±–æ–∫—Å—ã –≤–∏–∑—É–∞–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω—ã
- ‚úÖ Fallback —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚ö° –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å antiword

**–°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç:** http://127.0.0.1:8081

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–î–∞—Ç–∞:** 2025-10-23
